# RAG 작동 요약

---

## **jdbcTemplate**
**SQL문 실행 도구**  
jdbcTemplate.update로 전체 데이터 삭제  
**TRUNCATE 전체 초기화용 명령**  
delete : source 조건 없으면 전체 삭제 불가

---

## **PDF → Document**
업로드한 PDF에서 **Resource 추출**  
DocumentReader로 읽어 **리스트에 저장**  
TokenTextSplitter로 설정값 기준으로 **문서 분할**  
apply(), format() 사용 가능  
apply()는 **실제 문서 분할 기능**

---

## **vectorStore**
vectorStore.add로 **분할된 문서 임베딩 저장**  
DB(vector_store 테이블)에 저장된 데이터는 **유사도 검색에 사용**

---

## **RAG builder**
검색 조건 설정 객체  
**topK(3)** 으로 상위 3개 문서 검색  
**similarityThreshold(score)** 로 유사도 기준 설정  
source가 존재하면 **filterExpression** 으로 해당 데이터만 검색

---

## **SearchRequest**
조건 추가 후 **최종 검색 요청 객체**
searchReauest.builder() 했을 때 build하지 않고 Builder객체로 받아서 조건을 추가한 다음에 build하기

---

## **QuestionAnswerAdvisor**
벡터 저장소 검색 및 LLM 전달 어드바이저  

---

## **LLM**
chatClient.prompt()로 **질문 전달**  
최종 답변 생성

